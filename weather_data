import pandas as pd
import re

file_path = "/Users/saurabhkumar/Desktop/armaghdata.txt"
output_csv = "/Users/saurabhkumar/Desktop/armaghdata.csv"

clean_rows = []

with open(file_path, "r") as f:
    for line in f:
        # Keep only lines that start with a year

        if re.match(r"^\s*\d{4}", line):  # starts with year
            line = line.strip()
            parts = re.split(r'\s+', line)

            if len(parts) >= 7:
                # Optional: REMOVE footnotes like * or # or trailing text
                # -----------------------------------------
                #Uncomment the following block to clean footnotes:
                for i in range(2, 7):  # only clean columns tmax to sun
                    parts[i] = re.sub(r"[#*]", "", parts[i])
                if len(parts) > 7:  # If extra notes like "Provisional" exist
                    parts = parts[:7]
                # -----------------------------------------

                clean_rows.append(parts[:7])

df = pd.DataFrame(clean_rows, columns=["year", "month", "tmax", "tmin", "af", "rain", "sun"])
df.to_csv(output_csv, index=False)

print(f"✅ CSV saved to: {output_csv}")


Project Overview – Labour Market Task Classification Using Job Adverts

We are building a structured text analytics pipeline within the DAP environment to support the classification of job tasks described in job adverts. This work aligns with the OECD’s “Data as an Asset” methodology and aims to generate timely, granular insights into the types of data-related work being demanded across the labour market — including categories such as data entry, data analytics, and database administration.

A central motivation of this project, from both the ONS and OECD perspective, is to understand which jobs are actively involved in the production, handling, or transformation of data. Rather than relying on job titles alone, which can be misleading, we are analysing the actual content of job descriptions to detect the presence and intensity of data-producing tasks. This allows us to identify where in the workforce data-related activity is really happening.

By leveraging tools like SpaCy (already approved within DAP) and the en_core_web_md model, we can convert unstructured text into quantifiable indicators of task intensity, which are then aggregated at the SOC (Standard Occupational Classification) and industry sector level. The resulting indicators will provide valuable evidence for policymakers on the composition of the UK’s data workforce, inform digital skills planning, and support the design of real-time labour market dashboards and forecasting models.
