import pandas as pd
import re

file_path = "/Users/saurabhkumar/Desktop/armaghdata.txt"
output_csv = "/Users/saurabhkumar/Desktop/armaghdata.csv"

clean_rows = []

with open(file_path, "r") as f:
    for line in f:
        # Keep only lines that start with a year

        if re.match(r"^\s*\d{4}", line):  # starts with year
            line = line.strip()
            parts = re.split(r'\s+', line)

            if len(parts) >= 7:
                # Optional: REMOVE footnotes like * or # or trailing text
                # -----------------------------------------
                #Uncomment the following block to clean footnotes:
                for i in range(2, 7):  # only clean columns tmax to sun
                    parts[i] = re.sub(r"[#*]", "", parts[i])
                if len(parts) > 7:  # If extra notes like "Provisional" exist
                    parts = parts[:7]
                # -----------------------------------------

                clean_rows.append(parts[:7])

df = pd.DataFrame(clean_rows, columns=["year", "month", "tmax", "tmin", "af", "rain", "sun"])
df.to_csv(output_csv, index=False)

print(f"âœ… CSV saved to: {output_csv}")

Stated Month and Reporting Period

The VAT flash estimates are based on VAT returns received by HMRC within the first seven calendar days following the end of each month. These returns are used to produce an early indicator of turnover trends.

In practice, the returns included in the flash estimate are almost exclusively from businesses that report monthly. As a result, the data used for, say, the June publication will mostly reflect turnover that occurred in May.

While some VAT returns may be submitted on a quarterly basis, these businesses do not report every month and are therefore not consistently represented in the 7-day window used for the flash estimate. For this reason, the flash estimates are generally reflective of monthly reporting periods, unlike other VAT-based indicators that include a mix of reporting frequencies.

This distinction is important, as it means the stated month in the flash estimate closely aligns with the actual month of business activity for the majority of included records.
