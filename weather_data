# THE FIX: Apply the strict volume threshold to the OFFICIAL dictionary
MIN_GLOBAL_JOBS = 500

oecd_vocabulary = dictionary_df.filter(
    (F.col("relative_share") >= 10.0) & 
    (F.col("global_count") >= MIN_GLOBAL_JOBS)
)

# Optional: Print the top 30 true skills to the console to verify it worked
print(f"=== TRUE TOP 30 OECD DICTIONARY TERMS (By Volume) ===")
oecd_vocabulary.orderBy(F.col("global_count").desc()).limit(30).show(truncate=False)

# (Leave your saving code exactly as it is below this)
# e.g., oecd_vocabulary.write.mode("overwrite").parquet(...)
